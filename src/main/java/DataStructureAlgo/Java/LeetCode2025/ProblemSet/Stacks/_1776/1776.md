# Car Fleet II – Collision Times (Monotonic Stack)

## Problem Summary

You are given `n` cars on a one-lane road, sorted by position.
Each car is represented as:
```
cars[i] = [position_i, speed_i]
```

Rules:
- A car can collide **only with a car ahead of it**
- On collision, cars form a **fleet**
- A fleet moves at the **minimum speed** of its cars
- Once merged, the fleet behaves like a single car

### Goal

Return an array `answer` where:
- `answer[i]` = time when car `i` collides with the next car
- `-1` if it never collides

Precision within `1e-5` is acceptable.

---

## Key Observations

1. Cars are already sorted by position
2. A car can **only collide forward**
3. If `speed_back <= speed_front`, collision is impossible
4. Cars ahead may **change speed in the future** due to earlier collisions

➡️ Therefore, collision validity depends on **time**

---

## Collision Time Formula

For two cars `back` and `front`:

```
time = (front_pos - back_pos) / (back_speed - front_speed)
```


Valid only if:

```
back_speed > front_speed
```


---

## Core Idea

Process cars from **right → left** using a **monotonic stack** of candidate cars ahead.

For each car:
- Remove cars it can never collide with
- Remove cars it would collide with **after they’ve already merged**
- The first remaining car gives the earliest valid collision

---

## Why a Stack Works

The stack keeps **only valid collision candidates**.
Each car is:
- Pushed once
- Popped at most once

➡️ Total complexity is linear.

---

## Algorithm Steps

For each car `i` from right to left:

1. While stack is not empty:
   - Let `j = stack.top()`
   - If `speed[i] <= speed[j]` → pop `j`
   - Else compute collision time `t`
     - If `j` never collides OR `t <= collision_time[j]` → valid
     - Else → pop `j` (too late)
2. If stack is not empty → record collision time
3. Push `i` onto stack

---

# Interview Soundbite (1-liner)

```
“I process cars from right to left using a monotonic stack, removing cars that can’t be collided with or would collide too late, ensuring each car finds its earliest valid collision in linear time.”
```

# Common Pitfalls

- Forgetting that cars ahead may change speed

- Not checking collision time against front car’s own collision

- Using brute force → O(n²) (TLE)


#Related Problems

- Car Fleet (LC 853)

- Car Fleet II (LC 1776)

- Asteroid Collision

- Next Greater Element (monotonic stack pattern)